# 🌍 Python環境管理ガイド

## 概要

このプロジェクトは**仮想環境（venv）**を使用します。グローバルPython環境に影響を与えません。

---

## 🔍 環境チェックツール

### 1. check_global_python.bat

**用途:** グローバルPython環境の状態を確認

```bash
cd automation
check_global_python.bat
```

**出力例:**
```
========================================
グローバルPython環境チェック
========================================

[Pythonパス確認]
C:\Users\...\Python312\python.exe

[グローバルPythonバージョン]
Python 3.12.2

[インストール済みパッケージ（グローバル）]
合計パッケージ数: 45

[大容量パッケージを検出中...]
検出された大容量パッケージ:
pillow
moviepy
pydub
google-api-python-client

⚠️  警告: グローバル環境に45個のパッケージがインストールされています

推奨対応:
  1. このプロジェクトでは仮想環境を使用しています
  2. グローバル環境はクリーンに保つことを推奨します
  3. 不要なパッケージを削除するには cleanup_global_python.bat を実行してください
```

---

### 2. compare_environments.bat

**用途:** グローバル環境と仮想環境を比較

```bash
cd automation
compare_environments.bat
```

**出力例:**
```
========================================
Python環境比較
========================================

[グローバルPython環境]
Python 3.12.2
パス: C:\Users\...\Python312\python.exe
パッケージ数: 45 個

[仮想環境]
Python 3.12.2
パス: C:\Users\...\sleep\venv\Scripts\python.exe
パッケージ数: 28 個

========================================
パッケージ比較
========================================

[グローバル環境のみにあるパッケージ]
  - numpy
  - pandas
  - matplotlib
  - (他17個)

[仮想環境のみにあるパッケージ]
  なし（すべてグローバルにもある）

[両方にあるパッケージ]
  - pillow
  - pydub
  - moviepy
  - google-api-python-client
  - (他24個)
```

**解釈:**
- ✅ 仮想環境が正しく機能している
- ⚠️ グローバル環境に重複パッケージがある
- 💡 グローバル環境の重複を削除しても問題なし

---

### 3. cleanup_global_python.bat

**用途:** グローバル環境から不要なパッケージを削除

```bash
cd automation
cleanup_global_python.bat
```

**安全性:**
- オプション1: このプロジェクト関連のみ削除（推奨）
- オプション2: すべて削除（上級者向け）

**実行例:**
```
========================================
グローバルPython環境クリーンアップ
========================================

⚠️  警告: この操作はグローバルPython環境のパッケージを削除します

本当に続行しますか? (yes と入力): yes

[オプション選択]
1. このプロジェクト関連のパッケージのみ削除（安全）
2. pip以外のすべてのパッケージを削除（危険）
3. キャンセル

選択 (1/2/3): 1

[このプロジェクト関連パッケージを削除中...]
Found existing installation: moviepy 1.0.3
Uninstalling moviepy-1.0.3:
  Successfully uninstalled moviepy-1.0.3
...

✅ クリーンアップ完了
```

---

## 🎯 推奨される使い方

### ベストプラクティス

```
1. グローバルPython環境はクリーンに保つ
   └─ pip, setuptools のみ

2. プロジェクトごとに仮想環境を使う
   └─ このプロジェクト: sleep/venv/

3. 環境を定期的にチェック
   └─ check_global_python.bat を月1回実行
```

---

## 📊 環境の状態

### 理想的な状態

```
グローバル環境:
  - pip
  - setuptools
  合計: 2個

仮想環境（sleep/venv）:
  - pydub
  - moviepy
  - Pillow
  - google-api-python-client
  - ... (プロジェクト必要なもの)
  合計: 28個
```

### 問題がある状態

```
グローバル環境:
  - pip
  - setuptools
  - pydub          ← 重複
  - moviepy        ← 重複
  - Pillow         ← 重複
  - numpy          ← 不要
  - pandas         ← 不要
  - ...
  合計: 50個以上

解決方法:
  cleanup_global_python.bat を実行
```

---

## ❓ FAQ

### Q: グローバル環境のパッケージを削除しても大丈夫？

**A:** はい、このプロジェクトは仮想環境を使用するため問題ありません。

**確認方法:**
```bash
manual.bat

出力:
✅ 仮想環境で実行中: C:\Users\...\sleep\venv
```

この表示が出れば、グローバル環境に依存していません。

---

### Q: 他のプロジェクトに影響しない？

**A:** 他のプロジェクトが**グローバル環境に依存している**場合は影響があります。

**確認方法:**
1. 他のプロジェクトが仮想環境を使っているか確認
2. 使っていない場合は、そちらも仮想環境に移行を推奨

---

### Q: クリーンアップ後、再インストールは必要？

**A:** いいえ、必要ありません。

理由:
- このプロジェクトは`sleep/venv/`にパッケージがある
- `manual.bat`が自動で仮想環境を使用
- グローバル環境は参照しない

---

### Q: 間違って削除した場合は？

**A:** 必要に応じてグローバルにインストール可能です。

```bash
# グローバルにインストール（必要な場合のみ）
python -m pip install package_name
```

ただし、通常は必要ありません。

---

## 🔧 トラブルシューティング

### エラー: モジュールが見つからない

**症状:**
```
ImportError: No module named 'pydub'
```

**原因:** グローバルPythonで実行している

**解決方法:**
```bash
# ❌ 直接実行しない
python manual_mode_v2.py

# ✅ バッチファイルから実行
manual.bat
```

---

### 警告: パッケージ数が多い

**症状:**
```
⚠️  警告: グローバル環境に67個のパッケージがインストールされています
```

**影響:** なし（仮想環境を使っているため）

**推奨対応:**
```bash
cleanup_global_python.bat
```

---

## 📋 チェックリスト

定期メンテナンス（月1回推奨）:

- [ ] `check_global_python.bat` を実行
- [ ] グローバル環境のパッケージ数を確認
- [ ] 50個以上なら `cleanup_global_python.bat` を検討
- [ ] `compare_environments.bat` で重複を確認

---

## 🎉 まとめ

### このプロジェクトの環境戦略

```
✅ 仮想環境を使用（sleep/venv/）
✅ すべてのバッチファイルが仮想環境を直接指定
✅ グローバル環境に依存しない
✅ 他のプロジェクトと干渉しない
```

### 安心して使える理由

1. **完全分離**: 仮想環境とグローバル環境は独立
2. **自動選択**: manual.batが自動で仮想環境を使用
3. **チェック機能**: 起動時に環境を確認
4. **クリーンアップ**: 簡単にグローバル環境を整理可能

---

**推奨:** まず `check_global_python.bat` を実行して現状を確認してください。

